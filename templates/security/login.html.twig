{# templates/security/login.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Connexion{% endblock %}

{% block body %}
    <main class="auth">
        <section class="auth-wrap">
            <div class="card">
                <h1 class="title">Se connecter</h1>
                <p class="subtitle">Accédez à votre espace personnel.</p>

                {% if error %}
                    <div class="alert">
                        {{ error.messageKey|trans(error.messageData, 'security') }}
                    </div>
                {% endif %}

                {% if app.user %}
                    <div class="info">Déjà connecté en tant que <strong>{{ app.user.userIdentifier }}</strong>.</div>
                    <div class="cta-inline">
                        <a class="btn btn-primary" href="{{ path('app_dashboard') }}">Aller au dashboard</a>
                    </div>
                {% else %}
                    <form method="post" action="{{ path('app_login') }}" class="form" autocomplete="on">
                        <div class="form-row">
                            <label for="inputEmail">Email</label>
                            <input type="email" id="inputEmail" name="_username" value="{{ last_username }}" autocomplete="email" required autofocus>
                        </div>

                        <div class="form-row">
                            <label for="inputPassword">Mot de passe</label>
                            <input type="password" id="inputPassword" name="_password" autocomplete="current-password" required>
                        </div>

                        <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

                        <div class="form-row checkbox">
                            <input type="checkbox" id="remember_me" name="_remember_me" value="on">
                            <label for="remember_me">Se souvenir de moi</label>
                        </div>

                        <button class="btn btn-primary btn-lg" type="submit">Se connecter</button>
                    </form>

                    <div class="alt">
                        <span>Nouveau ici ?</span>
                        <a class="link" href="{{ path('app_register') }}">Créer un compte</a>
                    </div>
                {% endif %}
            </div>
        </section>
    </main>

    <style>
        :root{
            --bg:#0b1020; --fg:#e8eefc; --muted:rgba(232,238,252,.75);
            --card:rgba(255,255,255,.06); --stroke:rgba(255,255,255,.12);
            --primary:#2563eb; --danger:#ef4444;
        }
        .auth{min-height:100dvh;background:var(--bg);color:var(--fg);display:grid;place-items:center;padding:2rem}
        .auth-wrap{width:100%;max-width:420px}
        .card{background:var(--card);border:1px solid var(--stroke);border-radius:18px;padding:1.4rem 1.2rem 1.2rem;backdrop-filter:blur(8px)}
        .title{margin:0 0 .25rem;font-weight:900;font-size:1.6rem}
        .subtitle{margin:0 0 1rem;color:var(--muted)}
        .alert{background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.35);color:#fecaca;padding:.6rem .8rem;border-radius:12px;margin:.4rem 0 1rem}
        .info{background:rgba(37,99,235,.15);border:1px solid rgba(37,99,235,.35);color:#dbeafe;padding:.6rem .8rem;border-radius:12px;margin:.4rem 0 1rem}
        .form{display:grid;gap:.85rem;margin:.6rem 0 1.1rem}
        .form-row label{display:block;font-size:.9rem;margin:0 0 .35rem;color:var(--muted)}
        .form-row input[type="email"],
        .form-row input[type="password"]{width:100%;background:rgba(255,255,255,.06);border:1px solid var(--stroke);
            color:var(--fg);padding:.75rem .9rem;border-radius:12px;outline:none}
        .form-row input:focus{border-color:rgba(37,99,235,.6)}
        .form-row.checkbox{display:flex;align-items:center;gap:.55rem}
        .form-row.checkbox label{margin:0}
        .btn{display:inline-flex;justify-content:center;align-items:center;border-radius:12px;border:1px solid var(--stroke);font-weight:800}
        .btn-lg{padding:.85rem 1.1rem;width:100%}
        .btn-primary{background:var(--primary);color:#fff}
        .btn-primary:hover{filter:brightness(1.05)}
        .alt{margin-top:.8rem;display:flex;gap:.5rem;justify-content:center;color:var(--muted)}
        .link{color:#93c5fd;text-decoration:none}
        .link:hover{text-decoration:underline}
        .cta-inline{display:flex;justify-content:center}
    </style>
{% endblock %}
